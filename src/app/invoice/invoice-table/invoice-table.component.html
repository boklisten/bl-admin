<div class="row">
	<div class="col">
		<form>
			<div class="form-group form-inline">
				<input
					class="form-control ml-2"
					type="text"
					placeholder="search name or reference"
					name="searchFilter"
					[formControl]="filter"
				/>
			</div>
		</form>
	</div>
  <div class="col" *ngIf="selectedList !== {}">
		<button
			class="btn btn-sm btn-outline-primary"
			(click)="exportToExcel()"
		>
			<fa-icon icon="file-excel" class="mr-2"></fa-icon>
			<span>Print to visma invoice format</span>
		</button>
	</div>
</div>

<div class="row">
	<div class="col">
		<table class="table table-sm table-hover table-striped">
			<thead>
				<tr>
					<th scope="col">
						<app-blc-button-check
							[value]="selectAll"
							(valueChange)="onSelectAll()"
						>
						</app-blc-button-check>
					</th>
					<th scope="col">#</th>
					<th scope="col" i18n="@@invoiceTableItemName">Name</th>
					<th scope="col" i18n="@@invoiceTableItemDeadline">
						Deadline
					</th>
					<th scope="col" i18n="@@invoiceTableItemAmount">Amount</th>
					<th scope="col" i18n="@@invoiceTableItemPayed">Payed</th>
				</tr>
			</thead>
			<tbody *ngIf="invoices">
				<tr *ngFor="let invoice of (invoices$ | async); let i = index">
					<th (click)="onSelect(invoice.id)">
						<app-blc-button-check
							[value]="selectedList[invoice.id]"
						>
						</app-blc-button-check>
					</th>
          <th class="bl-link-black" [routerLink]="'/invoice/' + invoice.id">
						<ngb-highlight
							[result]="invoice.invoiceId"
							[term]="filter.value"
						></ngb-highlight>
					</th>
					<td>
						<span
							class="bl-link-black"
							[routerLink]="
								'/customer/' +
								invoice.customerInfo.userDetail +
								'/detail'
							"
						>
							<ngb-highlight
								[result]="invoice.customerInfo.name"
								[term]="filter.value"
							></ngb-highlight>
						</span>
					</td>
					<td>{{ invoice.duedate | blDate }}</td>
					<td>{{ invoice.payment.total.gross | blcPrice }}</td>
					<td
						[ngClass]="{
							'text-success': invoice.customerHavePayed,
							'text-danger': !invoice.customerHavePayed
						}"
					>
						<fa-icon
							[icon]="
								invoice.customerHavePayed
									? 'check-circle'
									: 'times-circle'
							"
						></fa-icon>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
